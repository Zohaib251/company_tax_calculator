<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Tax Calculator - Complete Replica</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Excel Tax Calculator - Complete Replica</h1>
            <p class="subtitle">Exact replication of "TAX COMPANY with logic.xlsx" with all formulas and logic</p>
        </header>

        <div class="controls">
            <button id="loadTestData" class="btn btn-primary">Load Test Data</button>
            <button id="resetAll" class="btn btn-secondary">Reset All</button>
            <button id="calculateTax" class="btn btn-success">Calculate Final Tax</button>
        </div>

        <div class="table-container">
            <table class="excel-table" id="taxTable">
                <thead>
                    <tr>
                        <th style="width: 40%">Description</th>
                        <th style="width: 10%">Reference</th>
                        <th style="width: 15%; background-color: #e6f7ff">TOTAL AMOUNTS<br><small>(USER INPUT)</small></th>
                        <th style="width: 15%; background-color: #f6ffed">AMOUNT EXEMPT FROM TAX<br><small>(CALCULATED)</small></th>
                        <th style="width: 15%; background-color: #fff7e6">AMOUNT SUBJECT TO NORMAL TAX<br><small>(CALCULATED)</small></th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Rows will be dynamically generated by JavaScript -->
                </tbody>
            </table>
        </div>

        <div class="results-panel" id="resultsPanel">
            <h2>Tax Calculation Results</h2>
            <div class="results-grid">
                <div class="result-card">
                    <div class="result-label">Normal Income Tax @ 29%</div>
                    <div class="result-value" id="normalTax">0</div>
                </div>
                <div class="result-card">
                    <div class="result-label">Final/Fixed Tax @ 2.5%</div>
                    <div class="result-value" id="finalTax">0</div>
                </div>
                <div class="result-card">
                    <div class="result-label">Alternate Corporate Tax @ 17%</div>
                    <div class="result-value" id="alternateTax">0</div>
                </div>
                <div class="result-card">
                    <div class="result-label">Minimum Tax @ 1.25%</div>
                    <div class="result-value" id="minimumTax">0</div>
                </div>
                <div class="result-card">
                    <div class="result-label">Tax Chargeable</div>
                    <div class="result-value" id="taxChargeable">0</div>
                </div>
                <div class="result-card">
                    <div class="result-label">Admitted Income Tax</div>
                    <div class="result-value" id="admittedTax">0</div>
                </div>
                <div class="result-card">
                    <div class="result-label">Refundable Income Tax</div>
                    <div class="result-value" id="refundableTax">0</div>
                </div>
            </div>
        </div>

        <div class="instructions">
            <h3>Instructions:</h3>
            <ul>
                <li>Only <strong>Column C (TOTAL AMOUNTS)</strong> cells are editable (blue background)</li>
                <li>Columns D and E are automatically calculated</li>
                <li>Export Ratio in Row 7 drives proportional exemptions throughout</li>
                <li>Click <strong>Load Test Data</strong> to populate with Excel sample values</li>
                <li>Click <strong>Calculate Tax</strong> to see final tax calculations</li>
            </ul>
        </div>
    </div>

    <script src="formula-engine.js"></script>
    <script src="app.js"></script>
</body>
</html>